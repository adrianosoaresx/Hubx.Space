{% extends 'perfil/perfil_subpage_base.html' %}
{% load eventos_extras %}
{% block title %}Calendário | Hubx{% endblock %}

{% block perfil_subpage_content %}
<section class="perfil-section active">
    <div class="section-header">
        <h2>Calendário de Eventos</h2>
    </div>
    <div class="calendar-nav">
        <a href="?mes={{ mes|add:'-1' }}&ano={{ ano }}" class="btn-secondary">&lt;</a>
        <span>{{ mes }}/{{ ano }}</span>
        <a href="?mes={{ mes|add:'1' }}&ano={{ ano }}" class="btn-secondary">&gt;</a>
    </div>
    <table class="calendar-table">
        <tr>
            {% for weekday in weekdays %}
            <th>{{ weekday }}</th>
            {% endfor %}
        </tr>
        {% for dia in dias %}
        {% if forloop.first or dia.weekday == 0 %}<tr>{% endif %}
        <td class="{% if dia.month != mes %}other-month{% endif %} {% if dia in eventos_por_dia %}has-event{% endif %}">
            <a href="?mes={{ dia.month }}&ano={{ dia.year }}#d{{ dia.day }}">{{ dia.day }}</a>
            {% if dia in eventos_por_dia %}
                <ul>
                {% for e in eventos_por_dia|dict_get:dia %}
                    <li><a href="{% url 'eventos:detail' e.pk %}" id="d{{ dia.day }}">{{ e.titulo }}</a></li>
                {% endfor %}
                </ul>
            {% endif %}
        </td>
        {% if dia.weekday == 6 %}</tr>{% endif %}
        {% endfor %}
    </table>
</section>
{% endblock %}
